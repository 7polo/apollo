var Tag=function(op){var $ele=op.ele;var $vIn=null;var $in=null;var _clear=op.clear!=false;var _value=[];this.getValue=function(){return _value};function renderer(){$ele.addClass("tag").empty();$ele.append('<div style="display: inline-block" class="labels"><input class="in '+(op.inputclass||"")+'" placeholder='+(op.placeholder||"")+'></div>');$in=$ele.find(".in");if(op.name){$ele.append('<input type="hidden" name="'+op.name+'"/>');$vIn=$ele.children("input[name='"+op.name+"']")}$in.keydown(function(event){if(event.keyCode==32||event.keyCode==13){addTag($(this).val());$(this).val("")};event.stopPropagation()});_value=[];(op.value||"").split(",").forEach(function(item){addTag(item)})}function addTag(tag){if(tag&&_value.indexOf(tag)==-1){_value.push(tag);var delDom=_clear?'<a href="#" title="Removing tag">x</a>':"";var label='<span class="tag"><span>'+tag+"</span>"+delDom+"</span>";$in.before(label);$in.siblings(".tag").children("a").unbind("click").on("click",function(){var index=_value.indexOf($(this).prev().text());if(index!=-1){_value.splice(index,1);$(this).parent().remove();if($vIn){$vIn.val(_value.join(","))}}});if($vIn){$vIn.val(_value.join(","))}}}function addCss(){var $style=$("style.tag");if($style.length==0){var css=`.labels .tag{margin-left:5px;border:0;-moz-border-radius:2px;-webkit-border-radius:2px;display:block;float:left;padding:2px 5px;text-decoration:none;background:#33cabb;color:#fff;margin-right:5px;margin-bottom:5px;font-family:'Microsoft yahei',Roboto,sans-serif;font-size:13px;line-height:18px}.labels .tag>a{padding-left:5px;font-weight:bold;color:rgba(255,255,255,0.5);text-decoration:none;font-size:12px}.tag .in{height:25px}
`;$ele.append(('<style class="tag">'+css+"</style>"))}}renderer();addCss()};(function(){$.fn.extend({tag:function(op){op=op||{};op.ele=$(this);return new Tag(op)}})})();
